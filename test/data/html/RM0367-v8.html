<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="../style.css"/>
  </head>
  <body>
    <h4 id="section7.2.3">7.2.3 MSI clock</h4>
    <p>The MSI clock signal is generated from an internal RC oscillator. Its frequency range can be <br/>adjusted by software by using the MSIRANGE[2:0] bits in the RCC_ICSCR register (see <br/><i><u>Section 7.3.2: Internal clock sources calibration register (RCC_ICSCR)</u></i>). Seven frequency <br/>ranges are available: 65.536 kHz, 131.072 kHz, 262.144 kHz, 524.288 kHz, 1.048 MHz, <br/>2.097 MHz (default value) and 4.194 MHz.</p>
    <p>The MSI clock is always used as system clock after restart from Reset and wake-up from <br/>Standby. After wake-up from Stop mode, the MSI clock can be selected as system clock <br/>instead of HSI16 (or HSI16/4).</p>
    <p>When the device restarts after a reset or a wake-up from Standby, the MSI frequency is set <br/>to its default value. The MSI frequency does not change after waking up from Stop.</p>
    <p>The MSI RC oscillator has the advantage of providing a low-cost (no external components) <br/>low-power clock source. It is used as wake-up clock in low-power modes to reduce power <br/>consumption.</p>
    <p>The MSIRDY flag in the RCC_CR register indicates whether the MSI RC is stable or not. At <br/>startup, the MSI RC output clock is not released until this bit is set by hardware.</p>
    <p>The MSI RC can be switched on and off by using the MSION bit in the RCC_CR register <br/><i>(see <u>Section 7.3.1</u></i>).</p>
    <p>It can also be used as a backup clock source (auxiliary clock) if the HSE crystal oscillator <br/>fails. Refer to <i><u>Section 7.2.10: HSE clock security system (CSS) on page 183</u></i>.</p>
    <p>
      <b>Calibration</b>
    </p>
    <p>The MSI RC oscillator frequency can vary from one chip to another due to manufacturing <br/>process variations, this is why each device is factory calibrated by ST for 1% accuracy at an <br/>ambient temperature, T<sub>A</sub>, of 25 &#176;C.</p>
    <p>After reset, the factory calibration value is loaded in the MSICAL[7:0] bits in the <br/>RCC_ICSCR register. If the application is subject to voltage or temperature variations, this <br/>may affect the RC oscillator speed. You can trim the MSI frequency in the application by <br/>using the MSITRIM[7:0] bits in the RCC_ICSCR register. For more details on how to <br/>measure the MSI frequency variation please refer to <i><u>Section 7.2.15: Internal/external clock </u></i><u><br/><i>measurement using TIM21</i></u>.</p>
    <h4 id="section7.2.4">7.2.4 HSI48 clock</h4>
    <p>The HSI48 clock signal is generated from an internal 48 MHz RC oscillator and can be used <br/>directly for USB and for random number generator (RNG).</p>
    <p>The internal 48MHz RC oscillator is mainly dedicated to provide a high precision clock to the <br/>USB peripheral by means of a special Clock Recovery System (CRS) circuitry. The CRS <br/>can use the USB SOF signal, the LSE or an external signal to automatically and quickly <br/>adjust the oscillator frequency on-fly. It is disabled as soon as the system enters Stop or <br/>Standby mode. When the CRS is not used, the HSI48 RC oscillator runs on its default <br/>frequency which is subject to manufacturing process variations.</p>
    <p>For more details on how to configure and use the CRS peripheral please refer to <i><u>Section 8: </u></i><u><br/><i>Clock recovery system (CRS)</i></u><i>.</i></p>
    <p>The HSI48 requires VREFINT and its buffer with 48 MHz RC to be enabled (see</p>
  </body>
</html>
